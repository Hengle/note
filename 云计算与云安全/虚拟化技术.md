<!-- TOC -->

- [1. 虚拟化分类](#1-虚拟化分类)
- [2. 服务器虚拟化](#2-服务器虚拟化)
    - [2.1. x86架构](#21-x86架构)
        - [2.1.1. 全虚拟化](#211-全虚拟化)
        - [2.1.2. 半虚拟化](#212-半虚拟化)
        - [2.1.3. 硬件辅助虚拟化](#213-硬件辅助虚拟化)
- [3. 硬件虚拟化](#3-硬件虚拟化)

<!-- /TOC -->
# 1. 虚拟化分类
* 服务器虚拟化：服务器资源虚拟化
* 网络虚拟化：网络设备与结构虚拟化
* 桌面虚拟化：桌面与应用虚拟化
* 软件定义存储：存储虚拟化
# 2. 服务器虚拟化
## 2.1. x86架构
x86架构将CPU分为4个特权级别，主机的操作系统运行在零环，虚拟机的操作系统就无法运行在零环了，这就导致虚拟机执行特权指令的时候出现权限问题。所以需要通过VMM来实现虚拟机对硬件的直接访问，技术方案有以下三种：
* 全虚拟化
* 半虚拟化
* 硬件辅助虚拟化
### 2.1.1. 全虚拟化
将虚拟机系统转移到Ring1级别，将VMM放到Ring0级别，所有虚拟机系统的特权指令会下放到VMM，经过二进制翻译技术转换，适配宿主平台。然后直接指令执行，将执行结果缓存以供之后使用。虚拟机的Ring3指令则会直接运行。全虚拟化不需要操作系统和硬件的辅助，虚拟机系统对于自身的虚拟化无感。
### 2.1.2. 半虚拟化
修改操作系统内核代码，使用超级调用来替代不可虚拟化的操作系统指令。不支持Windows操作系统，兼容性和可移植性差。
### 2.1.3. 硬件辅助虚拟化
Intel和AMD从硬件层面推出了虚拟化技术（VT-x和AMD-V），在硬件和Ring0之间插入了一个根模式特权级别，将VMM置于其中，则特权指令不需要再经过二进制翻译或者半虚拟化，可以直接得到执行。虚拟机的状态保存在虚拟机控制结构（VMCS，VT-x）或者虚拟机控制块（VMCB，AMD-V）中。
# 3. 硬件虚拟化
基于软件模拟的全虚拟化方法能够支持多个设备共享并不需要修改客户操作系统但上下文切换开销大性能低；基于直通独占的方式能够使虚拟机直通访问物理设备减少了虚拟机监控器的切换开销性能高但共享困难；基于硬件辅助虚拟化的全虚拟化方法（以 SR-IOV 技术为代表）解决了直通和共享的矛盾是虚拟化技术走向成熟的标志。自 2005 年 Intel 公司首次提出了针对 CPU 的硬件辅助虚拟化技术 VT-x 后该方法已经成为主流的 x86 平台虚拟化方法。目前基于硬件辅助的虚拟化方法在 CPU、内存、网络等传统硬件资源上获得了成功CPU 和内存虚拟化资源已经接近物理性能。
